<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="msapplication-tap-highlight" content="no" />
    <meta name="color-scheme" content="light dark" />
    <meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff" />
    <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#141414" />
    <meta http-equiv="Content-Security-Policy" content="
      default-src * 'self' 'unsafe-inline' 'unsafe-eval' data: blob: https: http:;
      script-src * 'self' 'unsafe-inline' 'unsafe-eval' data: blob: https: http:;
      style-src * 'self' 'unsafe-inline' data: blob: https: http:;
      img-src * 'self' data: blob: https: http:;
      font-src * 'self' data: blob: https: http:;
      connect-src * 'self' https: http: wss: ws:;
      frame-src * 'self' data: blob: https: http:;
      media-src * 'self' data: blob: https: http:;
      object-src * 'self' data: blob: https: http:;
      worker-src * 'self' data: blob: https: http:;
      child-src * 'self' data: blob: https: http:;
    ">
    <!-- Load Telegram Web App script with error handling -->
    <script>
      // Function to load the Telegram Web App script
      function loadTelegramScript() {
        return new Promise((resolve, reject) => {
          const script = document.createElement('script');
          script.src = 'https://telegram.org/js/telegram-web-app.js';
          script.async = true;
          script.onload = () => {
            console.log('Telegram Web App script loaded successfully');
            resolve();
          };
          script.onerror = (error) => {
            console.error('Failed to load Telegram Web App script:', error);
            reject(error);
          };
          document.head.appendChild(script);
        });
      }

      // Load the script and initialize the app
      loadTelegramScript()
        .then(() => {
          console.log('Telegram WebApp available:', !!window.Telegram?.WebApp);
        })
        .catch(error => {
          console.error('Error loading Telegram script:', error);
        });
    </script>
    <title>Food Ordering | Telegram Mini App</title>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
    <!-- Fallback script in case the module import fails -->
    <script>
      // Check if the app has loaded properly
      setTimeout(function() {
        if (document.body.innerHTML.trim() === '<div id="root"></div>') {
          console.log('Application failed to load properly, attempting to reload...');
          window.location.reload();
        }
      }, 3000);
    </script>
  </body>
</html>